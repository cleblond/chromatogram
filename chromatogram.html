<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chromatogram Simulator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        canvas {
            border: 1px solid #000;
            margin: 10px 0;
        }
        .controls {
            display: flex;
            flex-direction: column;
            max-width: 300px;
        }
        .controls label, .controls input {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <h1>Chromatogram Simulator</h1>
    <div class="controls">
        <label for="numPeaks">Number of Peaks:</label>
        <input type="number" id="numPeaks" min="1" value="1">
        
        <div id="peakInputs"></div>

        <button id="drawChromatogram">Draw Chromatogram</button>
        <button id="exportImage">Export Image</button>
    </div>
    <canvas id="chromatogramCanvas" width="800" height="400"></canvas>


</body>
</html>
<script>

document.addEventListener('DOMContentLoaded', () => {
    const numPeaksInput = document.getElementById('numPeaks');
    const peakInputsContainer = document.getElementById('peakInputs');
    const drawButton = document.getElementById('drawChromatogram');
    const exportButton = document.getElementById('exportImage');
    const canvas = document.getElementById('chromatogramCanvas');
    const ctx = canvas.getContext('2d');

    numPeaksInput.addEventListener('change', () => {
        updatePeakInputs();
    });

    drawButton.addEventListener('click', () => {
        drawChromatogram();
    });

    exportButton.addEventListener('click', () => {
        exportCanvasAsImage();
    });

    function updatePeakInputs() {
        peakInputsContainer.innerHTML = '';
        const numPeaks = parseInt(numPeaksInput.value);
        for (let i = 0; i < numPeaks; i++) {
            const peakDiv = document.createElement('div');
            peakDiv.innerHTML = `
                <h3>Peak ${i + 1}</h3>
                <label for="retentionTime${i}">Retention Time:</label>
                <input type="number" id="retentionTime${i}" step="0.1" value="${i * 2 + 2}">
                <label for="area${i}">Area:</label>
                <input type="number" id="area${i}" step="0.1" value="1">
                <label for="width${i}">Width (Standard Deviation):</label>
                <input type="number" id="width${i}" step="0.1" value="0.5">
            `;
            peakInputsContainer.appendChild(peakDiv);
        }
    }

    function drawChromatogram() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        const numPeaks = parseInt(numPeaksInput.value);
        const peaks = [];

        // Retrieve input values for each peak
        for (let i = 0; i < numPeaks; i++) {
            const retentionTime = parseFloat(document.getElementById(`retentionTime${i}`).value);
            const area = parseFloat(document.getElementById(`area${i}`).value);
            const width = parseFloat(document.getElementById(`width${i}`).value);
            peaks.push({ retentionTime, area, width });
        }

        // Draw each peak using a Gaussian function
        peaks.forEach(peak => drawGaussianPeak(peak.retentionTime, peak.area, peak.width));

        // Draw axes
        ctx.strokeStyle = 'black';
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.moveTo(50, canvas.height - 50);
        ctx.lineTo(canvas.width - 50, canvas.height - 50); // X-axis
        ctx.moveTo(50, canvas.height - 50);
        ctx.lineTo(50, 50); // Y-axis
        ctx.stroke();
    }

    function drawGaussianPeak(mu, area, sigma) {
        const scale = 50; // Scaling factor to fit within canvas
        const centerX = 50 + mu * scale; // Center of the peak
        const amplitude = area * scale; // Height of the peak

        ctx.beginPath();
        for (let x = 0; x < canvas.width; x++) {
            const xValue = (x - centerX) / scale;
            const yValue = amplitude * Math.exp(-0.5 * Math.pow(xValue / sigma, 2));
            const y = canvas.height - 50 - yValue;
            if (x === 0) ctx.moveTo(x, y);
            else ctx.lineTo(x, y);
        }
        ctx.strokeStyle = 'blue';
        ctx.lineWidth = 2;
        ctx.stroke();
    }

    function exportCanvasAsImage() {
        const link = document.createElement('a');
        link.download = 'chromatogram.png';
        link.href = canvas.toDataURL();
        link.click();
    }

    updatePeakInputs();
});




</script>
